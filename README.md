# Домашнее задание к занятию "`Резервное копирование`" - `Шереметьев Аким Русланович`

### Задание 1

1.1. В данном случае очевидно стоит воспользоваться полным резервным копированием (Full backup).

Полное резервное копирование сохраняет все данные базы на момент создания бэкапа, что в нашем случае позволяет восстановить состояние базы предыдущего дня в полном объёме. Данный метод резервного копирования хорош тем, что все данные содержатся в одной копии (не нужно собирать инкременты), быстро восстанавливает данные и прост в управлении. Однако полная копия может занимать большое количество пространства накопителей и в данном случае необходимо позаботиться об соответствующем объеме свободного места и настроить количество одновременно хранимых копий базы данных. Чтобы не замедлять работу пользователей в базе данных, полное бэкапирование можно проводить либо в специально назначенный день, либо ночью. 

1.2 Здесь можно использовать как инкрементальное (Incremental backup), так и дифференциальное копирование (Differential backup), в зависимости от потребностей компании. Оба метода могут помочь в восстановлении данных за час до поломки, но у каждого метода есть свои тонкости. 

Инкрементальное копирование занимает меньше места (относительно полного копирования), обладает высокой скоростью копирования (копирование будет незначительно влиять на работу пользователя в базе данных) и имеет больше точек восстановления, однако по скорости восстановления данных оно уступает остальным, так как при восстановлении данных необходимо восстановить сначала полную копию, а затем все последующие инкременты. Также данный метод копирования сильно завязан на целостности данных и если один инкремент будет поврежден, следующие окажутся недоступными (восстановится только полная копия + все инкременты, стоящие перед поврежденным блоком).

Если рассматривать дифференциальное копирование, то по сравнению с инкрементальным, скорость копирования данных будет снижена (соответственно и работа всей базы), но восстанавливаться данные будут быстрее, так как не нужно пересчета всех инкрементов, а достаточно полного бэкапа и последний дифференциал. Необходимо брать во внимание, что дифференциальный бэкап является накопительным, то есть каждая его копия содержит все новые и измененные данные с момента создания полного бэкапа, а это значит, что объем хранения будет больше, чем в случае использования инкрементального копирования.

### Задание 2

#### PGDUMP

Синопсис pgdump:

```
pg_dump [connection-option...] [option...] [dbname]
```

В разделе connection-option мы указываем данные для подключения к базе: пользователя, хост, порт.
В разделе option указываем дополнительные опции вроде подробностей вывода, формата резервной копии и подобное.
В разделе dbname пишется база данных, к которой мы подключаемся.

Соответственно команда будет выглядеть примерно следующим образом:

```
pg_dump -U postgres -h localhost -p 5432 -F c -b -v -f my_db_backup.dump my_db
```

Где:

-U - имя пользователя

-h - адрес сервера

-p - порт

-F c - формат резервной копии "custom" (в документации данный формат рекомендуется для pg_restore)

-b - включить большие объекты (BLOB)

-v - вывод подробной информации (verbose)

-f - имя файла, куда будут сохраняться данные

my_db - имя резервируемой базы данных

#### PGRESTORE

Синопсис pgrestore:

```
pg_restore [connection-option...] [option...] [filename]
```

В разделе connection-option мы указываем данные для подключения к базе: пользователя, хост, порт.
В разделе option указываем дополнительные опции по восстановлению.
В разделе filename требуется указать расположение созданного ранее бэкапа.

```
pg_restore -U postgres -h localhost -p 5432 -d my_db-restored -v my_db_backup.dump
```
-U - имя пользователя
-h - адрес сервера
-p - порт
-d - имя базы данных, куда производится восстановление (база должна существовать или её нужно создать заранее)
-v - указание о подробном выводе

### Задание 3


